# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# SAHOOL Skills Tests Workflow
# Tests for AI modules, TypeScript packages, and skill file validation
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

name: Skills Tests

on:
  push:
    branches: [main, develop, "feature/**", "release/**", "claude/**"]
    paths:
      - 'tests/unit/ai/**'
      - 'shared/mcp/**'
      - 'packages/**'
      - 'scripts/skills_cli.py'
      - '.github/workflows/skills-tests.yml'
  pull_request:
    branches: [main, develop]
    paths:
      - 'tests/unit/ai/**'
      - 'shared/mcp/**'
      - 'packages/**'
      - 'scripts/skills_cli.py'

# Restrict default permissions for all jobs
permissions:
  contents: read
  checks: write
  pull-requests: write

env:
  PYTHON_VERSION: "3.11"
  NODE_VERSION: "20"

jobs:
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  # Python AI Modules Tests
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  test-ai-modules:
    name: AI Modules Tests
    runs-on: ubuntu-latest
    timeout-minutes: 20

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'

      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install pytest pytest-asyncio pytest-cov pytest-xdist httpx pydantic jsonschema pyyaml

      - name: Run AI module tests
        run: |
          echo "üß™ Running AI module tests..."
          pytest tests/unit/ai/ -v --tb=short
        env:
          ENVIRONMENT: test
          PYTHONPATH: .
          JWT_SECRET_KEY: test-secret-key-for-unit-tests-only-32chars
          JWT_ALGORITHM: HS256
          DATABASE_URL: ""
          NATS_URL: ""

      - name: Test summary
        if: always()
        run: echo "‚úÖ AI module tests completed"

  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  # TypeScript Tests
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  test-typescript:
    name: TypeScript Tests
    runs-on: ubuntu-latest
    timeout-minutes: 20

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: |
          npm install --ignore-scripts --legacy-peer-deps

      - name: Run TypeScript type check
        run: |
          echo "üìù Running TypeScript type checks..."
          npx tsc --noEmit -p tsconfig.json || true
        continue-on-error: true

      - name: Run Vitest for shared packages
        run: |
          echo "üß™ Running Vitest tests for shared packages..."
          npm run test:packages -- --run --reporter=verbose --coverage || true
        continue-on-error: true
        env:
          CI: true

      - name: Run package-specific tests
        run: |
          echo "üß™ Running package-specific tests..."

          # Test api-client
          if [ -f "packages/api-client/package.json" ]; then
            echo "Testing api-client..."
            cd packages/api-client && npm test -- --run || echo "‚ö†Ô∏è api-client tests skipped"
            cd ../..
          fi

          # Test shared-hooks
          if [ -f "packages/shared-hooks/package.json" ]; then
            echo "Testing shared-hooks..."
            cd packages/shared-hooks && npm test -- --run || echo "‚ö†Ô∏è shared-hooks tests skipped"
            cd ../..
          fi

          # Test shared-utils
          if [ -f "packages/shared-utils/package.json" ]; then
            echo "Testing shared-utils..."
            cd packages/shared-utils && npm test -- --run || echo "‚ö†Ô∏è shared-utils tests skipped"
            cd ../..
          fi
        continue-on-error: true
        env:
          CI: true

      - name: Upload TypeScript test results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: typescript-test-results
          path: |
            packages/**/coverage/
            packages/**/*.lcov
          retention-days: 30
          if-no-files-found: warn

  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  # Skills File Validation
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  validate-skills:
    name: Skills Validation
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}

      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install pydantic pyyaml jsonschema httpx

      - name: Validate skills server file
        run: |
          echo "üîç Validating skills_server.py..."
          python -m py_compile shared/mcp/skills_server.py
          echo "‚úÖ skills_server.py is syntactically valid"

      - name: Validate examples_skills.py
        run: |
          echo "üîç Validating examples_skills.py..."
          python -m py_compile shared/mcp/examples_skills.py
          echo "‚úÖ examples_skills.py is syntactically valid"

      - name: Check MCP module imports
        run: |
          echo "üîç Checking MCP module imports..."
          python -c "
          import sys
          sys.path.insert(0, '.')
          try:
              from shared.mcp import skills_server
              from shared.mcp.skills_server import SAHOOLSkillsTools, ToolResult
              print('‚úÖ MCP skills_server module imports successfully')
          except ImportError as e:
              print(f'‚ùå Import error: {e}')
              sys.exit(1)
          "
        env:
          PYTHONPATH: .

      - name: Validate skills configuration structure
        run: |
          echo "üîç Validating skills configuration..."
          python -c "
          import json
          import os
          from pathlib import Path

          # Check if there are any skill configuration files
          skill_configs = list(Path('shared/mcp').glob('*.yaml')) + list(Path('shared/mcp').glob('*.yml'))

          if skill_configs:
              import yaml
              for config_file in skill_configs:
                  try:
                      with open(config_file) as f:
                          yaml.safe_load(f)
                      print(f'‚úÖ {config_file.name} is valid YAML')
                  except yaml.YAMLError as e:
                      print(f'‚ùå {config_file.name} has YAML errors: {e}')
          else:
              print('‚ÑπÔ∏è No skill configuration files found in shared/mcp')
          "

      - name: Validate skills CLI script
        run: |
          echo "üîç Validating skills_cli.py..."
          python -m py_compile scripts/skills_cli.py
          echo "‚úÖ skills_cli.py is syntactically valid"

      - name: Test skills CLI functionality (if present)
        run: |
          echo "üß™ Testing skills CLI functionality..."
          if [ -f "scripts/skills_cli.py" ]; then
            python scripts/skills_cli.py --help || echo "‚ö†Ô∏è Skills CLI help not available"
          else
            echo "‚ÑπÔ∏è skills_cli.py not found"
          fi
        continue-on-error: true

  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  # Coverage Summary and Reporting
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  coverage-report:
    name: Coverage Report
    runs-on: ubuntu-latest
    needs: [test-ai-modules, test-typescript]
    if: always()
    timeout-minutes: 10

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download AI coverage artifact
        uses: actions/download-artifact@v4
        with:
          name: ai-coverage-report
          path: coverage-ai
        continue-on-error: true

      - name: Download TypeScript coverage artifacts
        uses: actions/download-artifact@v4
        with:
          name: typescript-test-results
          path: coverage-ts
        continue-on-error: true

      - name: Merge coverage reports
        run: |
          echo "üìä Generating coverage summary..."

          if [ -f "coverage-ai/coverage-ai.xml" ]; then
            echo "‚úÖ AI modules coverage report found"
            # Extract coverage percentage from AI report
            python -c "
            import xml.etree.ElementTree as ET
            tree = ET.parse('coverage-ai/coverage-ai.xml')
            root = tree.getroot()
            coverage_pct = float(root.attrib.get('line-rate', 0)) * 100
            print(f'üìà AI Coverage: {coverage_pct:.2f}%')
            " || true
          fi

          if [ -d "coverage-ts" ]; then
            echo "‚úÖ TypeScript coverage found"
          fi

      - name: Upload combined coverage to Codecov
        uses: codecov/codecov-action@v4
        if: always()
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./coverage-ai/coverage-ai.xml
          fail_ci_if_error: false
          flags: skills-tests
          name: skills-coverage
        continue-on-error: true

      - name: Generate coverage summary
        run: |
          echo "## üìä Skills Tests Coverage Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Test Coverage by Module" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Module | Status |" >> $GITHUB_STEP_SUMMARY
          echo "|--------|--------|" >> $GITHUB_STEP_SUMMARY

          if [ -f "coverage-ai/coverage-ai.xml" ]; then
            echo "| AI Modules | ‚úÖ Covered |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| AI Modules | ‚ö†Ô∏è No report |" >> $GITHUB_STEP_SUMMARY
          fi

          if [ -d "coverage-ts" ]; then
            echo "| TypeScript | ‚úÖ Covered |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| TypeScript | ‚ö†Ô∏è No report |" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Artifacts" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- AI coverage HTML report available in artifacts" >> $GITHUB_STEP_SUMMARY
          echo "- TypeScript coverage reports available in artifacts" >> $GITHUB_STEP_SUMMARY

  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  # Test Results Summary
  # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  test-summary:
    name: Test Summary
    runs-on: ubuntu-latest
    needs: [test-ai-modules, test-typescript, validate-skills]
    if: always()

    steps:
      - name: Generate summary
        run: |
          echo "## üß™ Skills Tests Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Test Execution Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Test Suite | Status |" >> $GITHUB_STEP_SUMMARY
          echo "|-----------|--------|" >> $GITHUB_STEP_SUMMARY
          echo "| AI Modules | ${{ needs.test-ai-modules.result }} |" >> $GITHUB_STEP_SUMMARY
          echo "| TypeScript | ${{ needs.test-typescript.result }} |" >> $GITHUB_STEP_SUMMARY
          echo "| Skills Validation | ${{ needs.validate-skills.result }} |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Tested Components" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- ‚úÖ AI modules (tests/unit/ai/)" >> $GITHUB_STEP_SUMMARY
          echo "- ‚úÖ TypeScript packages (packages/**)" >> $GITHUB_STEP_SUMMARY
          echo "- ‚úÖ Skills server (shared/mcp/skills_server.py)" >> $GITHUB_STEP_SUMMARY
          echo "- ‚úÖ Skills examples (shared/mcp/examples_skills.py)" >> $GITHUB_STEP_SUMMARY
          echo "- ‚úÖ Skills CLI (scripts/skills_cli.py)" >> $GITHUB_STEP_SUMMARY

      - name: Check test results
        run: |
          FAILURES=0

          if [[ "${{ needs.test-ai-modules.result }}" == "failure" ]]; then
            echo "::warning::AI module tests failed - review required"
            FAILURES=$((FAILURES + 1))
          fi

          if [[ "${{ needs.test-typescript.result }}" == "failure" ]]; then
            echo "::warning::TypeScript tests failed - review required"
            FAILURES=$((FAILURES + 1))
          fi

          if [[ "${{ needs.validate-skills.result }}" == "failure" ]]; then
            echo "::error::Skills validation failed"
            FAILURES=$((FAILURES + 1))
          fi

          if [ $FAILURES -gt 0 ]; then
            echo "‚ùå $FAILURES test suite(s) had failures"
            exit 1
          else
            echo "‚úÖ All skills tests passed"
          fi
