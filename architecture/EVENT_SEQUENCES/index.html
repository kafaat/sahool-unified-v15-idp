
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Complete developer guide for the SAHOOL Agricultural Platform" name="description"/>
<meta content="KAFAAT Team" name="author"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/>
<title>SAHOOL Event Sequences - مخططات تسلسل الأحداث - SAHOOL Developer Documentation</title>
<link href="../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="light-green" data-md-color-primary="green" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#sahool-event-sequences-">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="SAHOOL Developer Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="SAHOOL Developer Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            SAHOOL Developer Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              SAHOOL Event Sequences - مخططات تسلسل الأحداث
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../index.md">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../getting-started/installation.md">
          
  
  
  Getting Started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../services/overview.md">
          
  
  
  Services

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../api/authentication/">
          
  
  
  API Reference

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../development/setup.md">
          
  
  
  Development

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contributing/guidelines.md">
          
  
  
  Contributing

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="SAHOOL Developer Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="SAHOOL Developer Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    SAHOOL Developer Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../index.md">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/installation.md">
<span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/quickstart.md">
<span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/architecture.md">
<span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Services
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/overview.md">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/starter.md">
<span class="md-ellipsis">
    
  
    Starter Package
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/professional.md">
<span class="md-ellipsis">
    
  
    Professional Package
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/enterprise.md">
<span class="md-ellipsis">
    
  
    Enterprise Package
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/authentication/">
<span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/field-ops.md">
<span class="md-ellipsis">
    
  
    Field Operations
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/weather/">
<span class="md-ellipsis">
    
  
    Weather
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/satellite.md">
<span class="md-ellipsis">
    
  
    Satellite
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Development
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../development/setup.md">
<span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../development/testing.md">
<span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../development/deployment.md">
<span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contributing/guidelines.md">
<span class="md-ellipsis">
    
  
    Guidelines
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contributing/code-style.md">
<span class="md-ellipsis">
    
  
    Code Style
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="sahool-event-sequences-">SAHOOL Event Sequences - مخططات تسلسل الأحداث<a class="headerlink" href="#sahool-event-sequences-" title="Permanent link">¶</a></h1>
<blockquote>
<p><strong>Version:</strong> 1.0.0
<strong>Last Updated:</strong> 2025-12-19
<strong>Architecture:</strong> Event-Driven (4-Layer)</p>
</blockquote>
<hr/>
<h2 id="overview">Overview | نظرة عامة<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2>
<p>This document defines the official event sequences for SAHOOL platform. All services must follow these patterns to maintain architectural integrity.</p>
<div class="codehilite"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────┐
│                    SAHOOL Event Architecture                        │
├─────────────────────────────────────────────────────────────────────┤
│  Layer 1: ACQUISITION    → Raw data ingestion                       │
│  Layer 2: INTELLIGENCE   → Feature extraction &amp; AI                  │
│  Layer 3: DECISION       → Advisory &amp; planning                      │
│  Layer 4: BUSINESS       → User-facing operations                   │
└─────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<hr/>
<h2 id="1-field-monitoring-chain">1. Field Monitoring Chain | سلسلة مراقبة الحقل<a class="headerlink" href="#1-field-monitoring-chain" title="Permanent link">¶</a></h2>
<h3 id="sequence-diagram-mermaid">Sequence Diagram (Mermaid)<a class="headerlink" href="#sequence-diagram-mermaid" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">SAT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">satellite</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">IND</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">indicators</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">CHI</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">crop</span><span class="o">-</span><span class="n">health</span><span class="o">-</span><span class="n">ai</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">YLD</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">yield</span><span class="o">-</span><span class="n">engine</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="kr">NOT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">notification</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">MKT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">marketplace</span><span class="o">-</span><span class="kr">service</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">SAT</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Acquisition</span>
<span class="w">    </span><span class="n">SAT</span><span class="o">-&gt;&gt;</span><span class="n">SAT</span><span class="o">:</span><span class="w"> </span><span class="n">Ingest</span><span class="w"> </span><span class="n">Sentinel</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="n">scene</span>
<span class="w">    </span><span class="n">SAT</span><span class="o">--&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">SatelliteSceneIngested</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">SAT</span><span class="o">--&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">IndexTileReady</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">IND</span><span class="p">,</span><span class="n">CHI</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">Intelligence</span>
<span class="w">    </span><span class="n">IND</span><span class="o">-&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">Compute</span><span class="w"> </span><span class="n">NDVI</span><span class="o">/</span><span class="n">EVI</span><span class="o">/</span><span class="n">NDRE</span>
<span class="w">    </span><span class="n">IND</span><span class="o">--&gt;&gt;</span><span class="n">CHI</span><span class="o">:</span><span class="w"> </span><span class="n">FieldIndicatorsComputed</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">IND</span><span class="o">--&gt;&gt;</span><span class="n">YLD</span><span class="o">:</span><span class="w"> </span><span class="n">FieldIndicatorsComputed</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">CHI</span><span class="o">-&gt;&gt;</span><span class="n">CHI</span><span class="o">:</span><span class="w"> </span><span class="n">Assess</span><span class="w"> </span><span class="n">crop</span><span class="w"> </span><span class="n">health</span>
<span class="w">    </span><span class="n">CHI</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">CropHealthAssessed</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">YLD</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">Decision</span>
<span class="w">    </span><span class="n">YLD</span><span class="o">-&gt;&gt;</span><span class="n">YLD</span><span class="o">:</span><span class="w"> </span><span class="n">Estimate</span><span class="w"> </span><span class="n">yield</span>
<span class="w">    </span><span class="n">YLD</span><span class="o">--&gt;&gt;</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">YieldEstimated</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">YLD</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">YieldEstimated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="kr">NOT</span><span class="p">,</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">Business</span>
<span class="w">    </span><span class="kr">NOT</span><span class="o">-&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">Queue</span><span class="w"> </span><span class="n">notifications</span>
<span class="w">    </span><span class="n">MKT</span><span class="o">-&gt;&gt;</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">Update</span><span class="w"> </span><span class="n">market</span><span class="w"> </span><span class="n">forecasts</span>
</code></pre></div>
<h3 id="ascii-diagram">ASCII Diagram<a class="headerlink" href="#ascii-diagram" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code>satellite-service
       │
       ├──[SatelliteSceneIngested.v1]──► indicators-service
       │                                        │
       └──[IndexTileReady.v1]──────────────────►│
                                                │
                           ┌────────────────────┴────────────────────┐
                           │                                         │
                           ▼                                         ▼
              [FieldIndicatorsComputed.v1]              [FieldIndicatorsComputed.v1]
                           │                                         │
                           ▼                                         ▼
                   crop-health-ai                              yield-engine
                           │                                         │
              [CropHealthAssessed.v1]                     [YieldEstimated.v1]
                           │                                         │
                           ├─────────────────┬───────────────────────┤
                           ▼                 ▼                       ▼
                notification-service    notification-service   marketplace-service
</code></pre></div>
<h3 id="events-table">Events Table<a class="headerlink" href="#events-table" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Producer</th>
<th>Consumers</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SatelliteSceneIngested.v1</code></td>
<td>satellite-service</td>
<td>indicators-service, disaster-assessment</td>
</tr>
<tr>
<td><code>IndexTileReady.v1</code></td>
<td>satellite-service</td>
<td>indicators-service, lai-estimation</td>
</tr>
<tr>
<td><code>FieldIndicatorsComputed.v1</code></td>
<td>indicators-service</td>
<td>crop-health-ai, yield-engine, fertilizer-advisor</td>
</tr>
<tr>
<td><code>CropHealthAssessed.v1</code></td>
<td>crop-health-ai</td>
<td>notification-service, community-chat</td>
</tr>
<tr>
<td><code>YieldEstimated.v1</code></td>
<td>yield-engine</td>
<td>yield-prediction, marketplace-service</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="2-weather-risk-chain">2. Weather &amp; Risk Chain | سلسلة الطقس والمخاطر<a class="headerlink" href="#2-weather-risk-chain" title="Permanent link">¶</a></h2>
<h3 id="sequence-diagram-mermaid_1">Sequence Diagram (Mermaid)<a class="headerlink" href="#sequence-diagram-mermaid_1" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">WEA</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">weather</span><span class="o">-</span><span class="n">advanced</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">CGM</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">crop</span><span class="o">-</span><span class="n">growth</span><span class="o">-</span><span class="n">model</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">FER</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">fertilizer</span><span class="o">-</span><span class="n">advisor</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">IRR</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">irrigation</span><span class="o">-</span><span class="n">smart</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">DIS</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">disaster</span><span class="o">-</span><span class="n">assessment</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="kr">NOT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">notification</span><span class="o">-</span><span class="kr">service</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">WEA</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Acquisition</span>
<span class="w">    </span><span class="n">WEA</span><span class="o">-&gt;&gt;</span><span class="n">WEA</span><span class="o">:</span><span class="w"> </span><span class="nf">Fetch</span><span class="w"> </span><span class="n">forecast</span><span class="w"> </span><span class="kt">data</span>
<span class="w">    </span><span class="n">WEA</span><span class="o">--&gt;&gt;</span><span class="n">CGM</span><span class="o">:</span><span class="w"> </span><span class="n">WeatherForecastReady</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">WEA</span><span class="o">--&gt;&gt;</span><span class="n">IRR</span><span class="o">:</span><span class="w"> </span><span class="n">WeatherForecastReady</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">WEA</span><span class="o">--&gt;&gt;</span><span class="n">DIS</span><span class="o">:</span><span class="w"> </span><span class="n">WeatherAlertIssued</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">DIS</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">Intelligence</span>
<span class="w">    </span><span class="n">DIS</span><span class="o">-&gt;&gt;</span><span class="n">DIS</span><span class="o">:</span><span class="w"> </span><span class="n">Assess</span><span class="w"> </span><span class="n">disaster</span><span class="w"> </span><span class="n">risk</span>
<span class="w">    </span><span class="n">DIS</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">DisasterRiskScored</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">CGM</span><span class="p">,</span><span class="n">IRR</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">Decision</span>
<span class="w">    </span><span class="n">CGM</span><span class="o">-&gt;&gt;</span><span class="n">CGM</span><span class="o">:</span><span class="w"> </span><span class="n">Estimate</span><span class="w"> </span><span class="n">growth</span><span class="w"> </span><span class="n">stage</span>
<span class="w">    </span><span class="n">CGM</span><span class="o">--&gt;&gt;</span><span class="n">FER</span><span class="o">:</span><span class="w"> </span><span class="n">GrowthStageEstimated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">FER</span><span class="o">-&gt;&gt;</span><span class="n">FER</span><span class="o">:</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">fertilizer</span><span class="w"> </span><span class="n">plan</span>
<span class="w">    </span><span class="n">FER</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">FertilizerPlanProposed</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">IRR</span><span class="o">-&gt;&gt;</span><span class="n">IRR</span><span class="o">:</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">irrigation</span><span class="w"> </span><span class="n">plan</span>
<span class="w">    </span><span class="n">IRR</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">IrrigationPlanProposed</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">Business</span>
<span class="w">    </span><span class="kr">NOT</span><span class="o">-&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">alerts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">farmers</span>
</code></pre></div>
<h3 id="ascii-diagram_1">ASCII Diagram<a class="headerlink" href="#ascii-diagram_1" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code>weather-advanced
       │
       ├──[WeatherForecastReady.v1]──► crop-growth-model
       │                                      │
       ├──[WeatherForecastReady.v1]──► irrigation-smart
       │                                      │
       └──[WeatherAlertIssued.v1]───► disaster-assessment
                                              │
                                    [DisasterRiskScored.v1]
                                              │
                                              ▼
       ┌──────────────────────────────────────┴──────────────────────────────────┐
       │                                                                          │
       ▼                                                                          ▼
crop-growth-model ──[GrowthStageEstimated.v1]──► fertilizer-advisor    notification-service
                                                        │
                                          [FertilizerPlanProposed.v1]
                                                        │
                                                        ▼
irrigation-smart ──[IrrigationPlanProposed.v1]──► notification-service
</code></pre></div>
<h3 id="events-table_1">Events Table<a class="headerlink" href="#events-table_1" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Producer</th>
<th>Consumers</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WeatherObserved.v1</code></td>
<td>weather-advanced</td>
<td>indicators-service, crop-health-ai</td>
</tr>
<tr>
<td><code>WeatherForecastReady.v1</code></td>
<td>weather-advanced</td>
<td>crop-growth-model, irrigation-smart, yield-prediction</td>
</tr>
<tr>
<td><code>WeatherAlertIssued.v1</code></td>
<td>weather-advanced</td>
<td>disaster-assessment, notification-service</td>
</tr>
<tr>
<td><code>GrowthStageEstimated.v1</code></td>
<td>crop-growth-model</td>
<td>fertilizer-advisor, yield-engine, notification-service</td>
</tr>
<tr>
<td><code>FertilizerPlanProposed.v1</code></td>
<td>fertilizer-advisor</td>
<td>notification-service, marketplace-service</td>
</tr>
<tr>
<td><code>IrrigationPlanProposed.v1</code></td>
<td>irrigation-smart</td>
<td>notification-service, iot-service</td>
</tr>
<tr>
<td><code>DisasterRiskScored.v1</code></td>
<td>disaster-assessment</td>
<td>notification-service, community-chat</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="3-iot-sensors-chain">3. IoT Sensors Chain | سلسلة الحساسات<a class="headerlink" href="#3-iot-sensors-chain" title="Permanent link">¶</a></h2>
<h3 id="sequence-diagram-mermaid_2">Sequence Diagram (Mermaid)<a class="headerlink" href="#sequence-diagram-mermaid_2" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">IOT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">iot</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">VIR</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kr">virtual</span><span class="o">-</span><span class="n">sensors</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">IND</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">indicators</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="kr">NOT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">notification</span><span class="o">-</span><span class="kr">service</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">IOT</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Acquisition</span>
<span class="w">    </span><span class="n">IOT</span><span class="o">-&gt;&gt;</span><span class="n">IOT</span><span class="o">:</span><span class="w"> </span><span class="n">Receive</span><span class="w"> </span><span class="n">sensor</span><span class="w"> </span><span class="kt">data</span>
<span class="w">    </span><span class="n">IOT</span><span class="o">--&gt;&gt;</span><span class="n">VIR</span><span class="o">:</span><span class="w"> </span><span class="n">SensorReadingIngested</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">IOT</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">SensorAlert</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">VIR</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">Acquisition</span><span class="w"> </span><span class="p">(</span><span class="n">Derived</span><span class="p">)</span>
<span class="w">    </span><span class="n">VIR</span><span class="o">-&gt;&gt;</span><span class="n">VIR</span><span class="o">:</span><span class="w"> </span><span class="n">Estimate</span><span class="w"> </span><span class="kr">virtual</span><span class="w"> </span><span class="n">readings</span>
<span class="w">    </span><span class="n">VIR</span><span class="o">--&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">VirtualSensorEstimated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">Intelligence</span>
<span class="w">    </span><span class="n">IND</span><span class="o">-&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">Compute</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">indicators</span>
<span class="w">    </span><span class="n">IND</span><span class="o">--&gt;&gt;</span><span class="n">IND</span><span class="o">:</span><span class="w"> </span><span class="n">FieldIndicatorsComputed</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">Business</span>
<span class="w">    </span><span class="kr">NOT</span><span class="o">-&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">Alert</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">critical</span><span class="w"> </span><span class="n">values</span>
</code></pre></div>
<h3 id="ascii-diagram_2">ASCII Diagram<a class="headerlink" href="#ascii-diagram_2" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code>iot-service (Physical Sensors)
       │
       ├──[SensorReadingIngested.v1]──► virtual-sensors
       │                                       │
       └──[SensorAlert.v1]────────────────────►│
                                               │
                              [VirtualSensorEstimated.v1]
                                               │
                                               ▼
                                      indicators-service
                                               │
                               [FieldIndicatorsComputed.v1]
                                               │
               ┌───────────────────────────────┴────────────────────────────────┐
               ▼                               ▼                                ▼
       crop-health-ai                   yield-engine                  fertilizer-advisor
</code></pre></div>
<h3 id="events-table_2">Events Table<a class="headerlink" href="#events-table_2" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Producer</th>
<th>Consumers</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SensorReadingIngested.v1</code></td>
<td>iot-service</td>
<td>virtual-sensors, indicators-service</td>
</tr>
<tr>
<td><code>DeviceStatusChanged.v1</code></td>
<td>iot-service</td>
<td>notification-service</td>
</tr>
<tr>
<td><code>SensorAlert.v1</code></td>
<td>iot-service</td>
<td>notification-service</td>
</tr>
<tr>
<td><code>VirtualSensorEstimated.v1</code></td>
<td>virtual-sensors</td>
<td>indicators-service, irrigation-smart</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="4-yield-to-market-chain">4. Yield to Market Chain | سلسلة الإنتاج للسوق<a class="headerlink" href="#4-yield-to-market-chain" title="Permanent link">¶</a></h2>
<h3 id="sequence-diagram-mermaid_3">Sequence Diagram (Mermaid)<a class="headerlink" href="#sequence-diagram-mermaid_3" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">CGM</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">crop</span><span class="o">-</span><span class="n">growth</span><span class="o">-</span><span class="n">model</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">YEN</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">yield</span><span class="o">-</span><span class="n">engine</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">YPR</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">yield</span><span class="o">-</span><span class="n">prediction</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">MKT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">marketplace</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="kr">NOT</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">notification</span><span class="o">-</span><span class="kr">service</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">BIL</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">billing</span><span class="o">-</span><span class="n">core</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">CGM</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">Decision</span>
<span class="w">    </span><span class="n">CGM</span><span class="o">-&gt;&gt;</span><span class="n">CGM</span><span class="o">:</span><span class="w"> </span><span class="n">Estimate</span><span class="w"> </span><span class="n">biomass</span>
<span class="w">    </span><span class="n">CGM</span><span class="o">--&gt;&gt;</span><span class="n">YEN</span><span class="o">:</span><span class="w"> </span><span class="n">BiomassEstimated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">YEN</span><span class="o">-&gt;&gt;</span><span class="n">YEN</span><span class="o">:</span><span class="w"> </span><span class="n">Calculate</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">estimate</span>
<span class="w">    </span><span class="n">YEN</span><span class="o">--&gt;&gt;</span><span class="n">YPR</span><span class="o">:</span><span class="w"> </span><span class="n">YieldEstimated</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">YEN</span><span class="o">--&gt;&gt;</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">YieldEstimated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">YPR</span><span class="o">-&gt;&gt;</span><span class="n">YPR</span><span class="o">:</span><span class="w"> </span><span class="n">ML</span><span class="w"> </span><span class="n">prediction</span>
<span class="w">    </span><span class="n">YPR</span><span class="o">--&gt;&gt;</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">YieldPredicted</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">YPR</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">YieldPredicted</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">Note</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">MKT</span><span class="p">,</span><span class="n">BIL</span><span class="o">:</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">Business</span>
<span class="w">    </span><span class="n">MKT</span><span class="o">-&gt;&gt;</span><span class="n">MKT</span><span class="o">:</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">order</span>
<span class="w">    </span><span class="n">MKT</span><span class="o">--&gt;&gt;</span><span class="n">BIL</span><span class="o">:</span><span class="w"> </span><span class="n">OrderCreated</span><span class="p">.</span><span class="n">v1</span>
<span class="w">    </span><span class="n">MKT</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">OrderCreated</span><span class="p">.</span><span class="n">v1</span>

<span class="w">    </span><span class="n">BIL</span><span class="o">-&gt;&gt;</span><span class="n">BIL</span><span class="o">:</span><span class="w"> </span><span class="nf">Process</span><span class="w"> </span><span class="n">payment</span>
<span class="w">    </span><span class="n">BIL</span><span class="o">--&gt;&gt;</span><span class="kr">NOT</span><span class="o">:</span><span class="w"> </span><span class="n">InvoiceIssued</span><span class="p">.</span><span class="n">v1</span>
</code></pre></div>
<h3 id="ascii-diagram_3">ASCII Diagram<a class="headerlink" href="#ascii-diagram_3" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code>crop-growth-model
       │
       └──[BiomassEstimated.v1]──► yield-engine
                                        │
                           ┌────────────┴────────────┐
                           ▼                         ▼
              [YieldEstimated.v1]        [YieldEstimated.v1]
                           │                         │
                           ▼                         ▼
                  yield-prediction           marketplace-service
                           │                         │
              [YieldPredicted.v1]          [OrderCreated.v1]
                           │                         │
               ┌───────────┴───────────┐             │
               ▼                       ▼             ▼
    marketplace-service      notification-service  billing-core
                                                      │
                                          [InvoiceIssued.v1]
                                                      │
                                                      ▼
                                            notification-service
</code></pre></div>
<h3 id="events-table_3">Events Table<a class="headerlink" href="#events-table_3" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Producer</th>
<th>Consumers</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BiomassEstimated.v1</code></td>
<td>crop-growth-model</td>
<td>yield-engine</td>
</tr>
<tr>
<td><code>YieldEstimated.v1</code></td>
<td>yield-engine</td>
<td>yield-prediction, marketplace-service</td>
</tr>
<tr>
<td><code>YieldPredicted.v1</code></td>
<td>yield-prediction</td>
<td>marketplace-service, notification-service</td>
</tr>
<tr>
<td><code>OrderCreated.v1</code></td>
<td>marketplace-service</td>
<td>billing-core, notification-service</td>
</tr>
<tr>
<td><code>OrderPaid.v1</code></td>
<td>marketplace-service</td>
<td>billing-core</td>
</tr>
<tr>
<td><code>InvoiceIssued.v1</code></td>
<td>billing-core</td>
<td>notification-service</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="architecture-rules">Architecture Rules | قواعد المعمارية<a class="headerlink" href="#architecture-rules" title="Permanent link">¶</a></h2>
<h3 id="layer-communication-rules">Layer Communication Rules<a class="headerlink" href="#layer-communication-rules" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────────┐
│  ALLOWED                           │  FORBIDDEN                             │
├────────────────────────────────────┼────────────────────────────────────────┤
│  Acquisition → Intelligence        │  Business → Acquisition                │
│  Intelligence → Decision           │  Decision → Acquisition                │
│  Decision → Business               │  Any layer skipping (1→3, 2→4)         │
│  Any layer → Notification (side)   │  Business → Intelligence               │
└────────────────────────────────────┴────────────────────────────────────────┘
</code></pre></div>
<h3 id="event-naming-convention">Event Naming Convention<a class="headerlink" href="#event-naming-convention" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Pattern: {Domain}.{Action}</span>
<span class="c1"># Version: Append to filename, field in payload</span>

<span class="c1"># Good Examples:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Satellite.SceneIngested</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Crop.HealthAssessed</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Advisor.IrrigationPlanProposed</span>

<span class="c1"># Bad Examples:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">satellite_scene_ingested</span><span class="w"> </span><span class="c1"># Wrong case</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CropHealthAssessment</span><span class="w"> </span><span class="c1"># Missing dot separator</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IrrigationPlan</span><span class="w"> </span><span class="c1"># Missing action verb</span>
</code></pre></div>
<h3 id="transport-configuration">Transport Configuration<a class="headerlink" href="#transport-configuration" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="nt">transport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nats</span>
<span class="nt">subject_pattern</span><span class="p">:</span><span class="w"> </span><span class="s">"sahool.{tenant_id}.{event_type}"</span>

<span class="c1"># Example subjects:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sahool.tenant-abc.Satellite.SceneIngested</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sahool.tenant-abc.Crop.HealthAssessed</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sahool.*.Weather.AlertIssued</span><span class="w">  </span><span class="c1"># Broadcast to all tenants</span>
</code></pre></div>
<hr/>
<h2 id="quick-reference">Quick Reference | مرجع سريع<a class="headerlink" href="#quick-reference" title="Permanent link">¶</a></h2>
<h3 id="all-events-by-layer">All Events by Layer<a class="headerlink" href="#all-events-by-layer" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Service</th>
<th>Produces</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Acquisition</strong></td>
<td>satellite-service</td>
<td>SatelliteSceneIngested, RasterTileReady, IndexTileReady</td>
</tr>
<tr>
<td></td>
<td>iot-service</td>
<td>SensorReadingIngested, DeviceStatusChanged, SensorAlert</td>
</tr>
<tr>
<td></td>
<td>weather-advanced</td>
<td>WeatherObserved, WeatherForecastReady, WeatherAlertIssued</td>
</tr>
<tr>
<td></td>
<td>virtual-sensors</td>
<td>VirtualSensorEstimated</td>
</tr>
<tr>
<td><strong>Intelligence</strong></td>
<td>indicators-service</td>
<td>FieldIndicatorsComputed</td>
</tr>
<tr>
<td></td>
<td>lai-estimation</td>
<td>LAIEstimated</td>
</tr>
<tr>
<td></td>
<td>crop-health-ai</td>
<td>CropHealthAssessed, CropStressDetected</td>
</tr>
<tr>
<td></td>
<td>disaster-assessment</td>
<td>DisasterRiskScored, DisasterEventDetected</td>
</tr>
<tr>
<td><strong>Decision</strong></td>
<td>crop-growth-model</td>
<td>GrowthStageEstimated, BiomassEstimated</td>
</tr>
<tr>
<td></td>
<td>fertilizer-advisor</td>
<td>FertilizerPlanProposed</td>
</tr>
<tr>
<td></td>
<td>irrigation-smart</td>
<td>IrrigationPlanProposed, IrrigationAlertIssued</td>
</tr>
<tr>
<td></td>
<td>yield-engine</td>
<td>YieldEstimated</td>
</tr>
<tr>
<td></td>
<td>yield-prediction</td>
<td>YieldPredicted, YieldConfidenceUpdated</td>
</tr>
<tr>
<td><strong>Business</strong></td>
<td>notification-service</td>
<td>NotificationQueued, NotificationSent</td>
</tr>
<tr>
<td></td>
<td>marketplace-service</td>
<td>OrderCreated, OrderPaid</td>
</tr>
<tr>
<td></td>
<td>billing-core</td>
<td>InvoiceIssued, PaymentFailed</td>
</tr>
<tr>
<td></td>
<td>community-chat</td>
<td>CommunityPostCreated</td>
</tr>
<tr>
<td></td>
<td>research-core</td>
<td>TrialCreated, ObservationLogged</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="related-documentation">Related Documentation<a class="headerlink" href="#related-documentation" title="Permanent link">¶</a></h2>
<ul>
<li><a href="../../governance/services.yaml">services.yaml</a> - Service registry with events</li>
<li><a href="../../packages/shared/events/">Event Schemas</a> - JSON Schema definitions</li>
<li><a href="../../packages/shared/events/index.json">Event Registry Index</a> - Event catalog</li>
</ul>
<hr/>
<p><em>Last verified: 2025-12-19</em></p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
</body>
</html>