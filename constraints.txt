# ═══════════════════════════════════════════════════════════════════════════════
# SAHOOL Platform - Central Dependency Constraints
# قيود المكتبات المركزية لمنصة سهول
# ═══════════════════════════════════════════════════════════════════════════════
#
# Usage:
#   pip install -c constraints.txt -r requirements.txt
#
# This file ensures version consistency across all services.
# Update versions here to propagate changes platform-wide.
#
# Last Updated: December 2025
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# Web Framework
# ─────────────────────────────────────────────────────────────────────────────
fastapi==0.126.0
uvicorn[standard]==0.34.0
starlette>=0.41.0  # Security: matches fastapi 0.126.0

# ─────────────────────────────────────────────────────────────────────────────
# Data Validation
# ─────────────────────────────────────────────────────────────────────────────
pydantic==2.9.2
pydantic-settings==2.6.1
pydantic-core>=2.27.0

# ─────────────────────────────────────────────────────────────────────────────
# HTTP Clients
# ─────────────────────────────────────────────────────────────────────────────
httpx==0.28.1
aiohttp>=3.11.12  # Security fix for CVE-2025-53643

# ─────────────────────────────────────────────────────────────────────────────
# Database
# ─────────────────────────────────────────────────────────────────────────────
asyncpg==0.30.0
tortoise-orm==0.21.7
aerich==0.7.2

# ─────────────────────────────────────────────────────────────────────────────
# Messaging
# ─────────────────────────────────────────────────────────────────────────────
nats-py==2.9.0
redis==5.2.1

# ─────────────────────────────────────────────────────────────────────────────
# Authentication
# ─────────────────────────────────────────────────────────────────────────────
python-jose[cryptography]>=3.4.0
passlib[bcrypt]==1.7.4

# ─────────────────────────────────────────────────────────────────────────────
# Observability
# ─────────────────────────────────────────────────────────────────────────────
prometheus-client==0.21.1
opentelemetry-api==1.29.0
opentelemetry-sdk==1.29.0
opentelemetry-instrumentation-fastapi==0.50b0
structlog==24.4.0

# ─────────────────────────────────────────────────────────────────────────────
# Scientific Computing
# Note: numpy<2.1.0 required for TensorFlow 2.18.0 compatibility
# ─────────────────────────────────────────────────────────────────────────────
numpy>=1.26.0,<2.1.0
scipy>=1.11.0,<1.15.0
Pillow==11.0.0

# ─────────────────────────────────────────────────────────────────────────────
# Machine Learning
# ─────────────────────────────────────────────────────────────────────────────
tensorflow-cpu==2.18.0

# ─────────────────────────────────────────────────────────────────────────────
# Testing
# ─────────────────────────────────────────────────────────────────────────────
pytest==8.3.4
pytest-asyncio==0.24.0
pytest-cov==4.1.0
pytest-mock==3.12.0
pytest-xdist==3.5.0

# ─────────────────────────────────────────────────────────────────────────────
# Development Tools
# ─────────────────────────────────────────────────────────────────────────────
ruff==0.8.4
pre-commit==4.0.1
black==24.10.0
isort==5.13.2

# ─────────────────────────────────────────────────────────────────────────────
# Utilities
# ─────────────────────────────────────────────────────────────────────────────
python-dotenv==1.0.1
python-multipart==0.0.18
python-dateutil==2.8.2
jsonschema==4.23.0

# ─────────────────────────────────────────────────────────────────────────────
# Firebase (Notifications)
# ─────────────────────────────────────────────────────────────────────────────
firebase-admin==6.6.0

# ─────────────────────────────────────────────────────────────────────────────
# Scheduling
# ─────────────────────────────────────────────────────────────────────────────
apscheduler==3.10.4

# ═══════════════════════════════════════════════════════════════════════════════
# Version Upgrade Notes
# ═══════════════════════════════════════════════════════════════════════════════
#
# FastAPI: 0.115.6 → 0.126.0 (security fixes, performance improvements)
# uvicorn: 0.32.1 → 0.34.0 (HTTP/2 improvements)
# numpy: Pinned to <2.1.0 for TensorFlow compatibility
# aiohttp: >=3.11.12 for CVE-2025-53643 fix
#
# Next upgrade targets:
# - TensorFlow 2.19.x (will allow numpy 2.x)
# - FastAPI 0.130.x (when stable)
# ═══════════════════════════════════════════════════════════════════════════════
