# ═══════════════════════════════════════════════════════════════════════════════
# AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
# Generated from: governance/services.yaml
# Regenerate: make generate-infra
# ═══════════════════════════════════════════════════════════════════════════════

services:
  postgres:
    image: postgis/postgis:16-3.4
    container_name: sahool-postgres
    environment:
    - POSTGRES_USER=${POSTGRES_USER:-sahool}
    - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-sahool_dev}
    - POSTGRES_DB=${POSTGRES_DB:-sahool}
    volumes:
    - postgres_data:/var/lib/postgresql/data
    ports:
    - ${POSTGRES_PORT:-5432}:5432
    healthcheck:
      test:
      - CMD-SHELL
      - pg_isready -U ${POSTGRES_USER:-sahool}
      interval: 5s
      timeout: 5s
      retries: 10
      start_period: 30s
    networks:
    - sahool-network
    restart: unless-stopped
  redis:
    image: redis:7.4-alpine
    container_name: sahool-redis
    command:
    - redis-server
    - --appendonly
    - 'yes'
    volumes:
    - redis_data:/data
    ports:
    - ${REDIS_PORT:-6379}:6379
    healthcheck:
      test:
      - CMD
      - redis-cli
      - ping
      interval: 5s
      timeout: 5s
      retries: 10
    networks:
    - sahool-network
    restart: unless-stopped
  nats:
    image: nats:2.10-alpine
    container_name: sahool-nats
    command:
    - --jetstream
    - --store_dir
    - /data
    volumes:
    - nats_data:/data
    ports:
    - ${NATS_PORT:-4222}:4222
    - 8222:8222
    healthcheck:
      test:
      - CMD
      - wget
      - --spider
      - -q
      - http://localhost:8222/healthz
      interval: 5s
      timeout: 5s
      retries: 10
    networks:
    - sahool-network
    restart: unless-stopped
  mqtt:
    image: eclipse-mosquitto:2
    container_name: sahool-mqtt
    volumes:
    - mqtt_data:/mosquitto/data
    - mqtt_log:/mosquitto/log
    ports:
    - ${MQTT_PORT:-1883}:1883
    - 9001:9001
    networks:
    - sahool-network
    restart: unless-stopped
  crop-growth-model:
    build:
      context: ./apps/services/crop-growth-model
      dockerfile: Dockerfile
    container_name: sahool-crop-growth-model
    ports:
    - 3023:3023
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3023
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3023/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=crop-growth-model
    - sahool.port=3023
    - sahool.category=crop
    - traefik.enable=true
    - traefik.http.routers.crop-growth-model.rule=PathPrefix(`/api/v1/crop/growth/model`)
  disaster-assessment:
    build:
      context: ./apps/services/disaster-assessment
      dockerfile: Dockerfile
    container_name: sahool-disaster-assessment
    ports:
    - 3020:3020
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3020
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_disaster
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3020/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=disaster-assessment
    - sahool.port=3020
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.disaster-assessment.rule=PathPrefix(`/api/v1/disaster/assessment`)
  lai-estimation:
    build:
      context: ./apps/services/lai-estimation
      dockerfile: Dockerfile
    container_name: sahool-lai-estimation
    ports:
    - 3022:3022
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3022
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3022/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=lai-estimation
    - sahool.port=3022
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.lai-estimation.rule=PathPrefix(`/api/v1/lai/estimation`)
  yield-prediction:
    build:
      context: ./apps/services/yield-prediction
      dockerfile: Dockerfile
    container_name: sahool-yield-prediction
    ports:
    - 3021:3021
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3021
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3021/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=yield-prediction
    - sahool.port=3021
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.yield-prediction.rule=PathPrefix(`/api/v1/yield/prediction`)
  marketplace-service:
    build:
      context: ./apps/services/marketplace-service
      dockerfile: Dockerfile
    container_name: sahool-marketplace-service
    ports:
    - 3010:3010
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3010
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_marketplace
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3010/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=marketplace-service
    - sahool.port=3010
    - sahool.category=community
    - traefik.enable=true
    - traefik.http.routers.marketplace-service.rule=PathPrefix(`/api/v1/marketplace/service`)
  community-chat:
    build:
      context: ./apps/services/community-chat
      dockerfile: Dockerfile
    container_name: sahool-community-chat
    ports:
    - 8097:8097
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8097
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_chat
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8097/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=community-chat
    - sahool.port=8097
    - sahool.category=community
    - traefik.enable=true
    - traefik.http.routers.community-chat.rule=PathPrefix(`/api/v1/community/chat`)
  iot-service:
    build:
      context: ./apps/services/iot-service
      dockerfile: Dockerfile
    container_name: sahool-iot-service
    ports:
    - 8117:8117
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8117
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_iot
    - MQTT_URL=${MQTT_URL:-mqtt://mqtt:1883}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8117/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
      mqtt:
        condition: service_started
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=iot-service
    - sahool.port=8117
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.iot-service.rule=PathPrefix(`/api/v1/iot/service`)
  research-core:
    build:
      context: ./apps/services/research-core
      dockerfile: Dockerfile
    container_name: sahool-research-core
    ports:
    - 3015:3015
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3015
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_research
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3015/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=research-core
    - sahool.port=3015
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.research-core.rule=PathPrefix(`/api/v1/research/core`)
  billing-core:
    build:
      context: ./apps/services/billing-core
      dockerfile: Dockerfile
    container_name: sahool-billing-core
    ports:
    - 8089:8089
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8089
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_billing
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8089/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=billing-core
    - sahool.port=8089
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.billing-core.rule=PathPrefix(`/api/v1/billing/core`)
  satellite-service:
    build:
      context: ./apps/services/satellite-service
      dockerfile: Dockerfile
    container_name: sahool-satellite-service
    ports:
    - 9190:9190
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=9190
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_satellite
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:9190/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=satellite-service
    - sahool.port=9190
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.satellite-service.rule=PathPrefix(`/api/v1/satellite/service`)
  weather-advanced:
    build:
      context: ./apps/services/weather-advanced
      dockerfile: Dockerfile
    container_name: sahool-weather-advanced
    ports:
    - 9092:9092
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=9092
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_weather
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:9092/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=weather-advanced
    - sahool.port=9092
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.weather-advanced.rule=PathPrefix(`/api/v1/weather/advanced`)
  indicators-service:
    build:
      context: ./apps/services/indicators-service
      dockerfile: Dockerfile
    container_name: sahool-indicators-service
    ports:
    - 8091:8091
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8091
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_indicators
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8091/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=indicators-service
    - sahool.port=8091
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.indicators-service.rule=PathPrefix(`/api/v1/indicators/service`)
  crop-health-ai:
    build:
      context: ./apps/services/crop-health-ai
      dockerfile: Dockerfile
    container_name: sahool-crop-health-ai
    ports:
    - 9095:9095
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=9095
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:9095/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=crop-health-ai
    - sahool.port=9095
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.crop-health-ai.rule=PathPrefix(`/api/v1/crop/health/ai`)
  virtual-sensors:
    build:
      context: ./apps/services/virtual-sensors
      dockerfile: Dockerfile
    container_name: sahool-virtual-sensors
    ports:
    - 8119:8119
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8119
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8119/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=virtual-sensors
    - sahool.port=8119
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.virtual-sensors.rule=PathPrefix(`/api/v1/virtual/sensors`)
  yield-engine:
    build:
      context: ./apps/services/yield-engine
      dockerfile: Dockerfile
    container_name: sahool-yield-engine
    ports:
    - 8098:8098
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8098
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8098/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=yield-engine
    - sahool.port=8098
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.yield-engine.rule=PathPrefix(`/api/v1/yield/engine`)
  fertilizer-advisor:
    build:
      context: ./apps/services/fertilizer-advisor
      dockerfile: Dockerfile
    container_name: sahool-fertilizer-advisor
    ports:
    - 9093:9093
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=9093
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_fertilizer
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:9093/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=fertilizer-advisor
    - sahool.port=9093
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.fertilizer-advisor.rule=PathPrefix(`/api/v1/fertilizer/advisor`)
  irrigation-smart:
    build:
      context: ./apps/services/irrigation-smart
      dockerfile: Dockerfile
    container_name: sahool-irrigation-smart
    ports:
    - 8094:8094
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8094
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_irrigation
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8094/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=irrigation-smart
    - sahool.port=8094
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.irrigation-smart.rule=PathPrefix(`/api/v1/irrigation/smart`)
  notification-service:
    build:
      context: ./apps/services/notification-service
      dockerfile: Dockerfile
    container_name: sahool-notification-service
    ports:
    - 8110:8110
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8110
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_notifications
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8110/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=notification-service
    - sahool.port=8110
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.notification-service.rule=PathPrefix(`/api/v1/notification/service`)
  mcp-server:
    build:
      context: ./apps/services/mcp-server
      dockerfile: Dockerfile
    container_name: sahool-mcp-server
    ports:
    - 8200:8200
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8200
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8200/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=mcp-server
    - sahool.port=8200
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.mcp-server.rule=PathPrefix(`/api/v1/mcp/server`)
  agro-rules:
    build:
      context: ./apps/services/agro-rules
      dockerfile: Dockerfile
    container_name: sahool-agro-rules
    ports:
    - 8151:8151
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8151
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8151/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=agro-rules
    - sahool.port=8151
    - sahool.category=crop
    - traefik.enable=true
    - traefik.http.routers.agro-rules.rule=PathPrefix(`/api/v1/agro/rules`)
  crop-intelligence-service:
    build:
      context: ./apps/services/crop-intelligence-service
      dockerfile: Dockerfile
    container_name: sahool-crop-intelligence-service
    ports:
    - 8095:8095
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8095
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8095/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=crop-intelligence-service
    - sahool.port=8095
    - sahool.category=crop
    - traefik.enable=true
    - traefik.http.routers.crop-intelligence-service.rule=PathPrefix(`/api/v1/crop/intelligence/service`)
  equipment-service:
    build:
      context: ./apps/services/equipment-service
      dockerfile: Dockerfile
    container_name: sahool-equipment-service
    ports:
    - 8101:8101
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8101
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_equipment
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8101/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=equipment-service
    - sahool.port=8101
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.equipment-service.rule=PathPrefix(`/api/v1/equipment/service`)
  task-service:
    build:
      context: ./apps/services/task-service
      dockerfile: Dockerfile
    container_name: sahool-task-service
    ports:
    - 8103:8103
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8103
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_tasks
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8103/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=task-service
    - sahool.port=8103
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.task-service.rule=PathPrefix(`/api/v1/task/service`)
  ws-gateway:
    build:
      context: ./apps/services/ws-gateway
      dockerfile: Dockerfile
    container_name: sahool-ws-gateway
    ports:
    - 8081:8081
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8081
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8081/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=ws-gateway
    - sahool.port=8081
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.ws-gateway.rule=PathPrefix(`/api/v1/ws/gateway`)
  ndvi-processor:
    build:
      context: ./apps/services/ndvi-processor
      dockerfile: Dockerfile
    container_name: sahool-ndvi-processor
    ports:
    - 8118:8118
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8118
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8118/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=ndvi-processor
    - sahool.port=8118
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.ndvi-processor.rule=PathPrefix(`/api/v1/ndvi/processor`)
  field-intelligence:
    build:
      context: ./apps/services/field-intelligence
      dockerfile: Dockerfile
    container_name: sahool-field-intelligence
    ports:
    - 8120:8120
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8120
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8120/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=field-intelligence
    - sahool.port=8120
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.field-intelligence.rule=PathPrefix(`/api/v1/field/intelligence`)
  vegetation-analysis-service:
    build:
      context: ./apps/services/vegetation-analysis-service
      dockerfile: Dockerfile
    container_name: sahool-vegetation-analysis-service
    ports:
    - 8090:8090
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8090
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8090/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=vegetation-analysis-service
    - sahool.port=8090
    - sahool.category=analytics
    - traefik.enable=true
    - traefik.http.routers.vegetation-analysis-service.rule=PathPrefix(`/api/v1/vegetation/analysis/service`)
  weather-service:
    build:
      context: ./apps/services/weather-service
      dockerfile: Dockerfile
    container_name: sahool-weather-service
    ports:
    - 8092:8092
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8092
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8092/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=weather-service
    - sahool.port=8092
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.weather-service.rule=PathPrefix(`/api/v1/weather/service`)
  skills-service:
    build:
      context: ./apps/services/skills-service
      dockerfile: Dockerfile
    container_name: sahool-skills-service
    ports:
    - 8121:8121
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8121
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    - DB_NAME=sahool_skills
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8121/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=skills-service
    - sahool.port=8121
    - sahool.category=crop
    - traefik.enable=true
    - traefik.http.routers.skills-service.rule=PathPrefix(`/api/v1/skills/service`)
  advisory-service:
    build:
      context: ./apps/services/advisory-service
      dockerfile: Dockerfile
    container_name: sahool-advisory-service
    ports:
    - 8093:8093
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8093
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8093/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=advisory-service
    - sahool.port=8093
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.advisory-service.rule=PathPrefix(`/api/v1/advisory/service`)
  field-management-service:
    build:
      context: ./apps/services/field-management-service
      dockerfile: Dockerfile
    container_name: sahool-field-management-service
    ports:
    - 3000:3000
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3000
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3000/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=field-management-service
    - sahool.port=3000
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.field-management-service.rule=PathPrefix(`/api/v1/field/management/service`)
  user-service:
    build:
      context: ./apps/services/user-service
      dockerfile: Dockerfile
    container_name: sahool-user-service
    ports:
    - 3025:3025
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=3025
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:3025/api/v1/health
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=user-service
    - sahool.port=3025
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.user-service.rule=PathPrefix(`/api/v1/user/service`)
  alert-service:
    build:
      context: ./apps/services/alert-service
      dockerfile: Dockerfile
    container_name: sahool-alert-service
    ports:
    - 8113:8113
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8113
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8113/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=alert-service
    - sahool.port=8113
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.alert-service.rule=PathPrefix(`/api/v1/alert/service`)
  agro-advisor:
    build:
      context: ./apps/services/agro-advisor
      dockerfile: Dockerfile
    container_name: sahool-agro-advisor
    ports:
    - 8105:8105
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8105
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8105/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=agro-advisor
    - sahool.port=8105
    - sahool.category=crop
    - traefik.enable=true
    - traefik.http.routers.agro-advisor.rule=PathPrefix(`/api/v1/agro/advisor`)
  astronomical-calendar:
    build:
      context: ./apps/services/astronomical-calendar
      dockerfile: Dockerfile
    container_name: sahool-astronomical-calendar
    ports:
    - 8111:8111
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8111
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8111/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=astronomical-calendar
    - sahool.port=8111
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.astronomical-calendar.rule=PathPrefix(`/api/v1/astronomical/calendar`)
  iot-gateway:
    build:
      context: ./apps/services/iot-gateway
      dockerfile: Dockerfile
    container_name: sahool-iot-gateway
    ports:
    - 8106:8106
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8106
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8106/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=iot-gateway
    - sahool.port=8106
    - sahool.category=integration
    - traefik.enable=true
    - traefik.http.routers.iot-gateway.rule=PathPrefix(`/api/v1/iot/gateway`)
  inventory-service:
    build:
      context: ./apps/services/inventory-service
      dockerfile: Dockerfile
    container_name: sahool-inventory-service
    ports:
    - 8116:8116
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8116
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8116/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=inventory-service
    - sahool.port=8116
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.inventory-service.rule=PathPrefix(`/api/v1/inventory/service`)
  field-chat:
    build:
      context: ./apps/services/field-chat
      dockerfile: Dockerfile
    container_name: sahool-field-chat
    ports:
    - 8099:8099
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8099
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8099/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=field-chat
    - sahool.port=8099
    - sahool.category=community
    - traefik.enable=true
    - traefik.http.routers.field-chat.rule=PathPrefix(`/api/v1/field/chat`)
  provider-config:
    build:
      context: ./apps/services/provider-config
      dockerfile: Dockerfile
    container_name: sahool-provider-config
    ports:
    - 8104:8104
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - PORT=8104
    - DATABASE_URL=${DATABASE_URL}
    - REDIS_URL=${REDIS_URL}
    - NATS_URL=${NATS_URL:-nats://nats:4222}
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:8104/healthz
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      nats:
        condition: service_healthy
    networks:
    - sahool-network
    restart: unless-stopped
    labels:
    - sahool.service=provider-config
    - sahool.port=8104
    - sahool.category=core
    - traefik.enable=true
    - traefik.http.routers.provider-config.rule=PathPrefix(`/api/v1/provider/config`)
  web:
    build:
      context: ./apps/web
      dockerfile: Dockerfile
    container_name: sahool-web
    ports:
    - 3000:3000
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - NEXT_PUBLIC_API_URL=${API_URL:-http://localhost:8000}
    networks:
    - sahool-network
    restart: unless-stopped
  admin:
    build:
      context: ./apps/admin
      dockerfile: Dockerfile
    container_name: sahool-admin
    ports:
    - 3001:3001
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - NEXT_PUBLIC_API_URL=${API_URL:-http://localhost:8000}
    networks:
    - sahool-network
    restart: unless-stopped
  mobile:
    build:
      context: ./apps/mobile
      dockerfile: Dockerfile
    container_name: sahool-mobile
    ports:
    - 3000:3000
    environment:
    - NODE_ENV=${NODE_ENV:-development}
    - NEXT_PUBLIC_API_URL=${API_URL:-http://localhost:8000}
    networks:
    - sahool-network
    restart: unless-stopped
networks:
  sahool-network:
    driver: bridge
volumes:
  postgres_data: {}
  redis_data: {}
  nats_data: {}
  mqtt_data: {}
  mqtt_log: {}
