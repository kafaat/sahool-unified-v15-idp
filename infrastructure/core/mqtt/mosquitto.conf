# Mosquitto Configuration for SAHOOL IoT Gateway
# إعدادات Mosquitto لبوابة إنترنت الأشياء سهول

# ═══════════════════════════════════════════════════════════════════════════════
# SECURITY CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# SECURITY: Disable anonymous access
# In production, all clients MUST authenticate
allow_anonymous false

# Password file for authentication (created via: mosquitto_passwd -c /mosquitto/config/passwd sahool_iot)
# Mount this file in docker-compose or create at container startup
password_file /mosquitto/config/passwd

# ═══════════════════════════════════════════════════════════════════════════════
# LISTENER CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# MQTT listener (port 1883)
listener 1883
protocol mqtt

# WebSocket listener for web clients (port 9001)
listener 9001
protocol websockets

# ═══════════════════════════════════════════════════════════════════════════════
# PERSISTENCE
# ═══════════════════════════════════════════════════════════════════════════════

persistence true
persistence_location /mosquitto/data/

# ═══════════════════════════════════════════════════════════════════════════════
# LOGGING
# ═══════════════════════════════════════════════════════════════════════════════

log_dest stdout
log_type error
log_type warning
log_type notice
# log_type information  # Disabled in production for performance

# ═══════════════════════════════════════════════════════════════════════════════
# CONNECTION & MESSAGE LIMITS
# ═══════════════════════════════════════════════════════════════════════════════

max_connections 1000
max_inflight_messages 20
max_packet_size 1048576
# message_size_limit deprecated - using max_packet_size instead

# ═══════════════════════════════════════════════════════════════════════════════
# ACL (Access Control List) - Fine-grained topic permissions
# ═══════════════════════════════════════════════════════════════════════════════

# Enable ACL-based topic permissions for security
acl_file /mosquitto/config/acl
