{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "events.ecological.pitfall.v1",
  "title": "EcologicalPitfallV1",
  "description": "Event emitted when an agricultural pitfall is diagnosed | حدث يُصدر عند تشخيص مزلق زراعي",
  "type": "object",
  "additionalProperties": false,
  "required": ["diagnosis_id", "farm_id", "tenant_id", "pitfall_id", "pitfall_name", "severity", "status", "created_at"],
  "properties": {
    "diagnosis_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier of the diagnosis | المعرف الفريد للتشخيص"
    },
    "farm_id": {
      "type": "string",
      "format": "uuid",
      "description": "Farm where pitfall was identified | المزرعة حيث تم تحديد المزلق"
    },
    "field_id": {
      "type": "string",
      "format": "uuid",
      "description": "Optional specific field | الحقل المحدد (اختياري)"
    },
    "tenant_id": {
      "type": "string",
      "format": "uuid",
      "description": "Tenant that owns the farm | المستأجر الذي يملك المزرعة"
    },
    "pitfall_id": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Pitfall identifier from knowledge base | معرف المزلق من قاعدة المعرفة"
    },
    "pitfall_name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 255,
      "description": "Pitfall name in English | اسم المزلق بالإنجليزية"
    },
    "pitfall_name_ar": {
      "type": "string",
      "maxLength": 255,
      "description": "Pitfall name in Arabic | اسم المزلق بالعربية"
    },
    "category": {
      "type": "string",
      "enum": ["soil", "water", "nutrition", "pest_management", "crop_management", "business"],
      "description": "Pitfall category | فئة المزلق"
    },
    "severity": {
      "type": "string",
      "enum": ["low", "medium", "high", "critical"],
      "description": "Severity level | مستوى الخطورة"
    },
    "status": {
      "type": "string",
      "enum": ["identified", "in_remediation", "resolved", "monitoring"],
      "description": "Resolution status | حالة الحل"
    },
    "match_confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Diagnosis confidence score | درجة ثقة التشخيص"
    },
    "symptoms_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of symptoms observed | عدد الأعراض الملاحظة"
    },
    "recommended_actions_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of recommended remediation actions | عدد إجراءات العلاج الموصى بها"
    },
    "estimated_recovery_months": {
      "type": "integer",
      "minimum": 0,
      "description": "Estimated months to recover | الأشهر المقدرة للتعافي"
    },
    "economic_impact": {
      "type": "string",
      "enum": ["low", "medium", "high"],
      "description": "Economic impact level | مستوى الأثر الاقتصادي"
    },
    "diagnosis_date": {
      "type": "string",
      "format": "date",
      "description": "Date of diagnosis | تاريخ التشخيص"
    },
    "diagnosed_by": {
      "type": "string",
      "format": "uuid",
      "description": "User who performed the diagnosis | المستخدم الذي أجرى التشخيص"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when the event was created | وقت إنشاء الحدث"
    }
  }
}
